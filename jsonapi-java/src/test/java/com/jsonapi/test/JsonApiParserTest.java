package com.jsonapi.test;

import com.jsonapi.JsonApiParser;
import org.junit.Before;
import org.junit.Test;

import java.util.List;

import static org.junit.Assert.assertTrue;
import static org.junit.Assert.assertNotNull;
import static org.junit.Assert.fail;

/**
 * Created by greg on 2/19/16.
 */
public class JsonApiParserTest {
    private static final String JSONAPI_BOOK_AUTHORS = "{\"data\":[{\"id\":\"1\",\"type\":\"authors\",\"attributes\":{\"name\":\"J. R. R. Tolkien\",\"date_of_birth\":\"1892-01-03\",\"date_of_death\":\"1973-09-02\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"books\":{\"links\":{\"self\":\"/v1/authors/1/relationships/books\",\"related\":\"/v1/authors/1/books\"}},\"photos\":{\"links\":{\"self\":\"/v1/authors/1/relationships/photos\",\"related\":\"/v1/authors/1/photos\"}}},\"links\":{\"self\":\"/v1/authors/1\"}},{\"id\":\"2\",\"type\":\"authors\",\"attributes\":{\"name\":\"J. K. Rowling\",\"date_of_birth\":\"1965-07-31\",\"date_of_death\":null,\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"books\":{\"links\":{\"self\":\"/v1/authors/2/relationships/books\",\"related\":\"/v1/authors/2/books\"}},\"photos\":{\"links\":{\"self\":\"/v1/authors/2/relationships/photos\",\"related\":\"/v1/authors/2/photos\"}}},\"links\":{\"self\":\"/v1/authors/2\"}}]}";
    private static final String JSONAPI_BOOK_AUTHOR = "{\"data\":{\"id\":\"1\",\"type\":\"authors\",\"attributes\":{\"name\":\"J. R. R. Tolkien\",\"date_of_birth\":\"1892-01-03\",\"date_of_death\":\"1973-09-02\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"books\":{\"links\":{\"self\":\"/v1/authors/1/relationships/books\",\"related\":\"/v1/authors/1/books\"}},\"photos\":{\"links\":{\"self\":\"/v1/authors/1/relationships/photos\",\"related\":\"/v1/authors/1/photos\"}}},\"links\":{\"self\":\"/v1/authors/1\"}}}";
    private static final String JSONAPI_BOOK_AUTHORS_INCLUDE_BOOKS = "{\"data\":[{\"id\":\"1\",\"type\":\"authors\",\"attributes\":{\"name\":\"J. R. R. Tolkien\",\"date_of_birth\":\"1892-01-03\",\"date_of_death\":\"1973-09-02\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"books\":{\"links\":{\"self\":\"/v1/authors/1/relationships/books\",\"related\":\"/v1/authors/1/books\"},\"data\":[{\"id\":\"1\",\"type\":\"books\"},{\"id\":\"2\",\"type\":\"books\"},{\"id\":\"3\",\"type\":\"books\"},{\"id\":\"11\",\"type\":\"books\"}]},\"photos\":{\"links\":{\"self\":\"/v1/authors/1/relationships/photos\",\"related\":\"/v1/authors/1/photos\"}}},\"links\":{\"self\":\"/v1/authors/1\"}},{\"id\":\"2\",\"type\":\"authors\",\"attributes\":{\"name\":\"J. K. Rowling\",\"date_of_birth\":\"1965-07-31\",\"date_of_death\":null,\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"books\":{\"links\":{\"self\":\"/v1/authors/2/relationships/books\",\"related\":\"/v1/authors/2/books\"},\"data\":[{\"id\":\"4\",\"type\":\"books\"},{\"id\":\"5\",\"type\":\"books\"},{\"id\":\"6\",\"type\":\"books\"},{\"id\":\"7\",\"type\":\"books\"},{\"id\":\"8\",\"type\":\"books\"},{\"id\":\"9\",\"type\":\"books\"},{\"id\":\"10\",\"type\":\"books\"}]},\"photos\":{\"links\":{\"self\":\"/v1/authors/2/relationships/photos\",\"related\":\"/v1/authors/2/photos\"}}},\"links\":{\"self\":\"/v1/authors/2\"}}],\"included\":[{\"id\":\"1\",\"type\":\"books\",\"attributes\":{\"date_published\":\"1954-07-29\",\"title\":\"The Fellowship of the Ring\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/authors/1/relationships/chapters\",\"related\":\"/v1/authors/1/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/authors/1/relationships/firstChapter\",\"related\":\"/v1/authors/1/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/authors/1/relationships/series\",\"related\":\"/v1/authors/1/series\"},\"data\":{\"id\":\"1\",\"type\":\"series\"}},\"author\":{\"links\":{\"self\":\"/v1/authors/1/relationships/author\",\"related\":\"/v1/authors/1/author\"},\"data\":{\"id\":\"1\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/authors/1/relationships/stores\",\"related\":\"/v1/authors/1/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/authors/1/relationships/photos\",\"related\":\"/v1/authors/1/photos\"}}},\"links\":{\"self\":\"/v1/authors/1\"}},{\"id\":\"2\",\"type\":\"books\",\"attributes\":{\"date_published\":\"1954-11-11\",\"title\":\"The Two Towers\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/authors/2/relationships/chapters\",\"related\":\"/v1/authors/2/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/authors/2/relationships/firstChapter\",\"related\":\"/v1/authors/2/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/authors/2/relationships/series\",\"related\":\"/v1/authors/2/series\"},\"data\":{\"id\":\"1\",\"type\":\"series\"}},\"author\":{\"links\":{\"self\":\"/v1/authors/2/relationships/author\",\"related\":\"/v1/authors/2/author\"},\"data\":{\"id\":\"1\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/authors/2/relationships/stores\",\"related\":\"/v1/authors/2/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/authors/2/relationships/photos\",\"related\":\"/v1/authors/2/photos\"}}},\"links\":{\"self\":\"/v1/authors/2\"}},{\"id\":\"3\",\"type\":\"books\",\"attributes\":{\"date_published\":\"1955-10-20\",\"title\":\"Return of the King\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/authors/3/relationships/chapters\",\"related\":\"/v1/authors/3/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/authors/3/relationships/firstChapter\",\"related\":\"/v1/authors/3/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/authors/3/relationships/series\",\"related\":\"/v1/authors/3/series\"},\"data\":{\"id\":\"1\",\"type\":\"series\"}},\"author\":{\"links\":{\"self\":\"/v1/authors/3/relationships/author\",\"related\":\"/v1/authors/3/author\"},\"data\":{\"id\":\"1\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/authors/3/relationships/stores\",\"related\":\"/v1/authors/3/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/authors/3/relationships/photos\",\"related\":\"/v1/authors/3/photos\"}}},\"links\":{\"self\":\"/v1/authors/3\"}},{\"id\":\"11\",\"type\":\"books\",\"attributes\":{\"date_published\":\"1937-09-21\",\"title\":\"The Hobbit\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/authors/11/relationships/chapters\",\"related\":\"/v1/authors/11/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/authors/11/relationships/firstChapter\",\"related\":\"/v1/authors/11/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/authors/11/relationships/series\",\"related\":\"/v1/authors/11/series\"},\"data\":null},\"author\":{\"links\":{\"self\":\"/v1/authors/11/relationships/author\",\"related\":\"/v1/authors/11/author\"},\"data\":{\"id\":\"1\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/authors/11/relationships/stores\",\"related\":\"/v1/authors/11/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/authors/11/relationships/photos\",\"related\":\"/v1/authors/11/photos\"}}},\"links\":{\"self\":\"/v1/authors/11\"}},{\"id\":\"4\",\"type\":\"books\",\"attributes\":{\"date_published\":\"1997-06-26\",\"title\":\"Harry Potter and the Philosopher's Stone\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/authors/4/relationships/chapters\",\"related\":\"/v1/authors/4/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/authors/4/relationships/firstChapter\",\"related\":\"/v1/authors/4/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/authors/4/relationships/series\",\"related\":\"/v1/authors/4/series\"},\"data\":{\"id\":\"2\",\"type\":\"series\"}},\"author\":{\"links\":{\"self\":\"/v1/authors/4/relationships/author\",\"related\":\"/v1/authors/4/author\"},\"data\":{\"id\":\"2\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/authors/4/relationships/stores\",\"related\":\"/v1/authors/4/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/authors/4/relationships/photos\",\"related\":\"/v1/authors/4/photos\"}}},\"links\":{\"self\":\"/v1/authors/4\"}},{\"id\":\"5\",\"type\":\"books\",\"attributes\":{\"date_published\":\"1998-07-02\",\"title\":\"Harry Potter and the Chamber of Secrets\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/authors/5/relationships/chapters\",\"related\":\"/v1/authors/5/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/authors/5/relationships/firstChapter\",\"related\":\"/v1/authors/5/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/authors/5/relationships/series\",\"related\":\"/v1/authors/5/series\"},\"data\":{\"id\":\"2\",\"type\":\"series\"}},\"author\":{\"links\":{\"self\":\"/v1/authors/5/relationships/author\",\"related\":\"/v1/authors/5/author\"},\"data\":{\"id\":\"2\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/authors/5/relationships/stores\",\"related\":\"/v1/authors/5/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/authors/5/relationships/photos\",\"related\":\"/v1/authors/5/photos\"}}},\"links\":{\"self\":\"/v1/authors/5\"}},{\"id\":\"6\",\"type\":\"books\",\"attributes\":{\"date_published\":\"1999-07-08\",\"title\":\"Harry Potter and the Prisoner of Azkaban\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/authors/6/relationships/chapters\",\"related\":\"/v1/authors/6/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/authors/6/relationships/firstChapter\",\"related\":\"/v1/authors/6/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/authors/6/relationships/series\",\"related\":\"/v1/authors/6/series\"},\"data\":{\"id\":\"2\",\"type\":\"series\"}},\"author\":{\"links\":{\"self\":\"/v1/authors/6/relationships/author\",\"related\":\"/v1/authors/6/author\"},\"data\":{\"id\":\"2\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/authors/6/relationships/stores\",\"related\":\"/v1/authors/6/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/authors/6/relationships/photos\",\"related\":\"/v1/authors/6/photos\"}}},\"links\":{\"self\":\"/v1/authors/6\"}},{\"id\":\"7\",\"type\":\"books\",\"attributes\":{\"date_published\":\"2000-07-08\",\"title\":\"Harry Potter and the Goblet of Fire\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/authors/7/relationships/chapters\",\"related\":\"/v1/authors/7/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/authors/7/relationships/firstChapter\",\"related\":\"/v1/authors/7/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/authors/7/relationships/series\",\"related\":\"/v1/authors/7/series\"},\"data\":{\"id\":\"2\",\"type\":\"series\"}},\"author\":{\"links\":{\"self\":\"/v1/authors/7/relationships/author\",\"related\":\"/v1/authors/7/author\"},\"data\":{\"id\":\"2\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/authors/7/relationships/stores\",\"related\":\"/v1/authors/7/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/authors/7/relationships/photos\",\"related\":\"/v1/authors/7/photos\"}}},\"links\":{\"self\":\"/v1/authors/7\"}},{\"id\":\"8\",\"type\":\"books\",\"attributes\":{\"date_published\":\"2003-06-21\",\"title\":\"Harry Potter and the Order of the Phoenix\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/authors/8/relationships/chapters\",\"related\":\"/v1/authors/8/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/authors/8/relationships/firstChapter\",\"related\":\"/v1/authors/8/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/authors/8/relationships/series\",\"related\":\"/v1/authors/8/series\"},\"data\":{\"id\":\"2\",\"type\":\"series\"}},\"author\":{\"links\":{\"self\":\"/v1/authors/8/relationships/author\",\"related\":\"/v1/authors/8/author\"},\"data\":{\"id\":\"2\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/authors/8/relationships/stores\",\"related\":\"/v1/authors/8/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/authors/8/relationships/photos\",\"related\":\"/v1/authors/8/photos\"}}},\"links\":{\"self\":\"/v1/authors/8\"}},{\"id\":\"9\",\"type\":\"books\",\"attributes\":{\"date_published\":\"2005-07-16\",\"title\":\"Harry Potter and the Half-Blood Prince\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/authors/9/relationships/chapters\",\"related\":\"/v1/authors/9/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/authors/9/relationships/firstChapter\",\"related\":\"/v1/authors/9/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/authors/9/relationships/series\",\"related\":\"/v1/authors/9/series\"},\"data\":{\"id\":\"2\",\"type\":\"series\"}},\"author\":{\"links\":{\"self\":\"/v1/authors/9/relationships/author\",\"related\":\"/v1/authors/9/author\"},\"data\":{\"id\":\"2\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/authors/9/relationships/stores\",\"related\":\"/v1/authors/9/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/authors/9/relationships/photos\",\"related\":\"/v1/authors/9/photos\"}}},\"links\":{\"self\":\"/v1/authors/9\"}},{\"id\":\"10\",\"type\":\"books\",\"attributes\":{\"date_published\":\"2007-07-21\",\"title\":\"Harry Potter and the Deathly Hallows\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/authors/10/relationships/chapters\",\"related\":\"/v1/authors/10/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/authors/10/relationships/firstChapter\",\"related\":\"/v1/authors/10/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/authors/10/relationships/series\",\"related\":\"/v1/authors/10/series\"},\"data\":{\"id\":\"2\",\"type\":\"series\"}},\"author\":{\"links\":{\"self\":\"/v1/authors/10/relationships/author\",\"related\":\"/v1/authors/10/author\"},\"data\":{\"id\":\"2\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/authors/10/relationships/stores\",\"related\":\"/v1/authors/10/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/authors/10/relationships/photos\",\"related\":\"/v1/authors/10/photos\"}}},\"links\":{\"self\":\"/v1/authors/10\"}}]}";
    private static final String JSONAPI_BOOK_BOOKS = "{\"data\":[{\"id\":\"1\",\"type\":\"books\",\"attributes\":{\"date_published\":\"1954-07-29\",\"title\":\"The Fellowship of the Ring\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/books/1/relationships/chapters\",\"related\":\"/v1/books/1/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/books/1/relationships/firstChapter\",\"related\":\"/v1/books/1/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/books/1/relationships/series\",\"related\":\"/v1/books/1/series\"},\"data\":{\"id\":\"1\",\"type\":\"series\"}},\"author\":{\"links\":{\"self\":\"/v1/books/1/relationships/author\",\"related\":\"/v1/books/1/author\"},\"data\":{\"id\":\"1\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/books/1/relationships/stores\",\"related\":\"/v1/books/1/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/books/1/relationships/photos\",\"related\":\"/v1/books/1/photos\"}}},\"links\":{\"self\":\"/v1/books/1\"}},{\"id\":\"2\",\"type\":\"books\",\"attributes\":{\"date_published\":\"1954-11-11\",\"title\":\"The Two Towers\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/books/2/relationships/chapters\",\"related\":\"/v1/books/2/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/books/2/relationships/firstChapter\",\"related\":\"/v1/books/2/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/books/2/relationships/series\",\"related\":\"/v1/books/2/series\"},\"data\":{\"id\":\"1\",\"type\":\"series\"}},\"author\":{\"links\":{\"self\":\"/v1/books/2/relationships/author\",\"related\":\"/v1/books/2/author\"},\"data\":{\"id\":\"1\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/books/2/relationships/stores\",\"related\":\"/v1/books/2/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/books/2/relationships/photos\",\"related\":\"/v1/books/2/photos\"}}},\"links\":{\"self\":\"/v1/books/2\"}},{\"id\":\"3\",\"type\":\"books\",\"attributes\":{\"date_published\":\"1955-10-20\",\"title\":\"Return of the King\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/books/3/relationships/chapters\",\"related\":\"/v1/books/3/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/books/3/relationships/firstChapter\",\"related\":\"/v1/books/3/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/books/3/relationships/series\",\"related\":\"/v1/books/3/series\"},\"data\":{\"id\":\"1\",\"type\":\"series\"}},\"author\":{\"links\":{\"self\":\"/v1/books/3/relationships/author\",\"related\":\"/v1/books/3/author\"},\"data\":{\"id\":\"1\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/books/3/relationships/stores\",\"related\":\"/v1/books/3/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/books/3/relationships/photos\",\"related\":\"/v1/books/3/photos\"}}},\"links\":{\"self\":\"/v1/books/3\"}},{\"id\":\"4\",\"type\":\"books\",\"attributes\":{\"date_published\":\"1997-06-26\",\"title\":\"Harry Potter and the Philosopher's Stone\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/books/4/relationships/chapters\",\"related\":\"/v1/books/4/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/books/4/relationships/firstChapter\",\"related\":\"/v1/books/4/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/books/4/relationships/series\",\"related\":\"/v1/books/4/series\"},\"data\":{\"id\":\"2\",\"type\":\"series\"}},\"author\":{\"links\":{\"self\":\"/v1/books/4/relationships/author\",\"related\":\"/v1/books/4/author\"},\"data\":{\"id\":\"2\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/books/4/relationships/stores\",\"related\":\"/v1/books/4/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/books/4/relationships/photos\",\"related\":\"/v1/books/4/photos\"}}},\"links\":{\"self\":\"/v1/books/4\"}},{\"id\":\"5\",\"type\":\"books\",\"attributes\":{\"date_published\":\"1998-07-02\",\"title\":\"Harry Potter and the Chamber of Secrets\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/books/5/relationships/chapters\",\"related\":\"/v1/books/5/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/books/5/relationships/firstChapter\",\"related\":\"/v1/books/5/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/books/5/relationships/series\",\"related\":\"/v1/books/5/series\"},\"data\":{\"id\":\"2\",\"type\":\"series\"}},\"author\":{\"links\":{\"self\":\"/v1/books/5/relationships/author\",\"related\":\"/v1/books/5/author\"},\"data\":{\"id\":\"2\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/books/5/relationships/stores\",\"related\":\"/v1/books/5/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/books/5/relationships/photos\",\"related\":\"/v1/books/5/photos\"}}},\"links\":{\"self\":\"/v1/books/5\"}},{\"id\":\"6\",\"type\":\"books\",\"attributes\":{\"date_published\":\"1999-07-08\",\"title\":\"Harry Potter and the Prisoner of Azkaban\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/books/6/relationships/chapters\",\"related\":\"/v1/books/6/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/books/6/relationships/firstChapter\",\"related\":\"/v1/books/6/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/books/6/relationships/series\",\"related\":\"/v1/books/6/series\"},\"data\":{\"id\":\"2\",\"type\":\"series\"}},\"author\":{\"links\":{\"self\":\"/v1/books/6/relationships/author\",\"related\":\"/v1/books/6/author\"},\"data\":{\"id\":\"2\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/books/6/relationships/stores\",\"related\":\"/v1/books/6/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/books/6/relationships/photos\",\"related\":\"/v1/books/6/photos\"}}},\"links\":{\"self\":\"/v1/books/6\"}},{\"id\":\"7\",\"type\":\"books\",\"attributes\":{\"date_published\":\"2000-07-08\",\"title\":\"Harry Potter and the Goblet of Fire\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/books/7/relationships/chapters\",\"related\":\"/v1/books/7/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/books/7/relationships/firstChapter\",\"related\":\"/v1/books/7/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/books/7/relationships/series\",\"related\":\"/v1/books/7/series\"},\"data\":{\"id\":\"2\",\"type\":\"series\"}},\"author\":{\"links\":{\"self\":\"/v1/books/7/relationships/author\",\"related\":\"/v1/books/7/author\"},\"data\":{\"id\":\"2\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/books/7/relationships/stores\",\"related\":\"/v1/books/7/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/books/7/relationships/photos\",\"related\":\"/v1/books/7/photos\"}}},\"links\":{\"self\":\"/v1/books/7\"}},{\"id\":\"8\",\"type\":\"books\",\"attributes\":{\"date_published\":\"2003-06-21\",\"title\":\"Harry Potter and the Order of the Phoenix\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/books/8/relationships/chapters\",\"related\":\"/v1/books/8/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/books/8/relationships/firstChapter\",\"related\":\"/v1/books/8/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/books/8/relationships/series\",\"related\":\"/v1/books/8/series\"},\"data\":{\"id\":\"2\",\"type\":\"series\"}},\"author\":{\"links\":{\"self\":\"/v1/books/8/relationships/author\",\"related\":\"/v1/books/8/author\"},\"data\":{\"id\":\"2\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/books/8/relationships/stores\",\"related\":\"/v1/books/8/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/books/8/relationships/photos\",\"related\":\"/v1/books/8/photos\"}}},\"links\":{\"self\":\"/v1/books/8\"}},{\"id\":\"9\",\"type\":\"books\",\"attributes\":{\"date_published\":\"2005-07-16\",\"title\":\"Harry Potter and the Half-Blood Prince\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/books/9/relationships/chapters\",\"related\":\"/v1/books/9/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/books/9/relationships/firstChapter\",\"related\":\"/v1/books/9/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/books/9/relationships/series\",\"related\":\"/v1/books/9/series\"},\"data\":{\"id\":\"2\",\"type\":\"series\"}},\"author\":{\"links\":{\"self\":\"/v1/books/9/relationships/author\",\"related\":\"/v1/books/9/author\"},\"data\":{\"id\":\"2\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/books/9/relationships/stores\",\"related\":\"/v1/books/9/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/books/9/relationships/photos\",\"related\":\"/v1/books/9/photos\"}}},\"links\":{\"self\":\"/v1/books/9\"}},{\"id\":\"10\",\"type\":\"books\",\"attributes\":{\"date_published\":\"2007-07-21\",\"title\":\"Harry Potter and the Deathly Hallows\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/books/10/relationships/chapters\",\"related\":\"/v1/books/10/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/books/10/relationships/firstChapter\",\"related\":\"/v1/books/10/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/books/10/relationships/series\",\"related\":\"/v1/books/10/series\"},\"data\":{\"id\":\"2\",\"type\":\"series\"}},\"author\":{\"links\":{\"self\":\"/v1/books/10/relationships/author\",\"related\":\"/v1/books/10/author\"},\"data\":{\"id\":\"2\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/books/10/relationships/stores\",\"related\":\"/v1/books/10/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/books/10/relationships/photos\",\"related\":\"/v1/books/10/photos\"}}},\"links\":{\"self\":\"/v1/books/10\"}},{\"id\":\"11\",\"type\":\"books\",\"attributes\":{\"date_published\":\"1937-09-21\",\"title\":\"The Hobbit\",\"created_at\":\"2016-02-19 19:09:58\",\"updated_at\":\"2016-02-19 19:09:58\"},\"relationships\":{\"chapters\":{\"links\":{\"self\":\"/v1/books/11/relationships/chapters\",\"related\":\"/v1/books/11/chapters\"}},\"firstChapter\":{\"links\":{\"self\":\"/v1/books/11/relationships/firstChapter\",\"related\":\"/v1/books/11/firstChapter\"}},\"series\":{\"links\":{\"self\":\"/v1/books/11/relationships/series\",\"related\":\"/v1/books/11/series\"},\"data\":null},\"author\":{\"links\":{\"self\":\"/v1/books/11/relationships/author\",\"related\":\"/v1/books/11/author\"},\"data\":{\"id\":\"1\",\"type\":\"authors\"}},\"stores\":{\"links\":{\"self\":\"/v1/books/11/relationships/stores\",\"related\":\"/v1/books/11/stores\"}},\"photos\":{\"links\":{\"self\":\"/v1/books/11/relationships/photos\",\"related\":\"/v1/books/11/photos\"}}},\"links\":{\"self\":\"/v1/books/11\"}}]}";

    private static JsonApiParser parser;

    @Before
    public void init() {
        parser = new JsonApiParser();
    }

    @Test
    public void testJsonApiAuthors() {
        List<Author> authors = (List<Author>) parser.parse(JSONAPI_BOOK_AUTHORS, Author.class);

        assertNotNull(authors);
        for(Author a : authors) {
            assertNotNull(a);
            assertNotNull(a.self);
        }
        assertTrue(authors.size() == 2);
    }

    @Test
    public void testJsonApiAuthor() {
        Author author = (Author) parser.parse(JSONAPI_BOOK_AUTHOR, Author.class);

        assertNotNull(author);
        assertTrue(author.name.equals("J. R. R. Tolkien"));
    }

    @Test
    public void testJsonApiAuthorsBadCast() {
        try {
            Author authors = (Author) parser.parse(JSONAPI_BOOK_AUTHORS, Author.class);
            fail();
        }catch(ClassCastException e) {
            assertNotNull(e);
        }
    }

    @Test
    public void testJsonApiAuthorsIncludeBooks() {
        List<Author> authors = (List<Author>) parser.parse(JSONAPI_BOOK_AUTHORS_INCLUDE_BOOKS, Author.class);
        assertNotNull(authors);
        for(Author a : authors) {
            assertNotNull(a);
            assertNotNull(a.books);
            assertNotNull(a.self);
            for(Book b : a.books) {
                assertNotNull(b.self);
                assertNotNull(b.related);
            }
        }
        assertTrue(authors.size() == 2);
    }
}
